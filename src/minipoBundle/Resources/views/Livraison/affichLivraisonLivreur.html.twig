{% extends 'baseLivreur.html.twig' %}
{% block content %}
    {% if listeliv==NULL  %}
        Pas de formation
    {% else %}
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Liste Livraison</h4>
                <div class="table-responsive">
                    <div class="dataTables_wrapper">
                        <div id="example_filter" class="dataTables_filter">
                            <label>Etat Livraison: <select class="custom-select col-6" id="etatl">
                                    <option value="all" selected="">All</option>
                                    <option value="livree">Livree</option>
                                    <option value="non livree">Non livree</option>
                                    <option value="refusee">Refusee</option>
                                </select></label>
                            <label>Destination:<input type="search" class="" placeholder="" aria-controls="example" id="destination"></label>
                        </div>

                    <table class="table table-striped" id="table-data">
                        <tr> <th>Matricule livraison</th>
                            <th>Destination</th>
                            <th>Statut</th>
                            <th>Date livraison</th>
                            <th>Action</th>
                        </tr>
                        {% for elt in listeliv %}
                            <tr>
                                <td>{{ elt.matriculel }}</td>
                                <td>{{ elt.destination }}</td>
                                <td>{{ elt.etatl }}</td>
                                <td>{{ elt.dateliv }}</td>
                                <td class="text-nowrap">
                                    <a href="/livreur/updateEtat/{{ elt.idliv }}" data-toggle="tooltip" data-original-title="Edit"> <i class="fa fa-pencil text-inverse m-r-10"></i> </a>
                                </td>
                            </tr>
                        {% endfor %}

                    </table>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

{% endblock %}
{% block javascripts %}
{{ parent() }}
<script type="application/javascript">

$( document ).ready(function() {
    console.log( "ready!" );
$("#destination").keyup(function(){
    if($(this).val() !== "")
    $.ajax({
        type: "POST",
        url: "/livreur/search",
        data: JSON.stringify({"etatl": $('#etatl').val(), "destination": "%"+$(this).val()+"%"}),
        dataType:"json"
    })
        .always(function( data ) {
            // insert data into div
            $("#table-data").html(data.responseText);
        });
    else
        $.ajax({
            type: "POST",
            url: "/livreur/search",
            data: JSON.stringify({"etatl": $('#etatl').val()}),
            dataType:"json"
        })
            .always(function( data ) {
                // insert data into div
                $("#table-data").html(data.responseText);
            });
    });
    $("#etatl").change(function(){
        if($("#destination").val() !== "")
            $.ajax({
                type: "POST",
                url: "/livreur/search",
                data: JSON.stringify({"etatl": $(this).val(), "destination": "%"+$("#destination").val()+"%"}),
                dataType:"json"
            })
                .always(function( data ) {
                    // insert data into div
                    $("#table-data").html(data.responseText);
                });
        else
            $.ajax({
                type: "POST",
                url: "/livreur/search",
                data: JSON.stringify({"etatl": $(this).val()}),
                dataType:"json"
            })
                .always(function( data ) {
                    // insert data into div
                    $("#table-data").html(data.responseText);
                });
    });

});

    </script>
{% endblock %}





